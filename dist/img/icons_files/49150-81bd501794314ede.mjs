(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[49150],{989881:(e,t,i)=>{var n=i(247816),o=i(899291)(n);e.exports=o},247816:(e,t,i)=>{var n=i(228483),o=i(3674);e.exports=function(e,t){return e&&n(e,t,o)}},702958:(e,t,i)=>{var n=i(646384),o=i(690939);e.exports=function(e,t,i,s){var r=i.length,a=r,d=!s;if(null==e)return!a;for(e=Object(e);r--;){var l=i[r];if(d&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++r<a;){var c=(l=i[r])[0],u=e[c],h=l[1];if(d&&l[2]){if(void 0===u&&!(c in e))return!1}else{var p=new n;if(s)var g=s(u,h,c,e,t,p);if(!(void 0===g?o(h,u,3,s,p):g))return!1}}return!0}},267206:(e,t,i)=>{var n=i(191573),o=i(716432),s=i(406557),r=i(701469),a=i(139601);e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?r(e)?o(e[0],e[1]):n(e):a(e)}},269199:(e,t,i)=>{var n=i(989881),o=i(498612);e.exports=function(e,t){var i=-1,s=o(e)?Array(e.length):[];return n(e,(function(e,n,o){s[++i]=t(e,n,o)})),s}},191573:(e,t,i)=>{var n=i(702958),o=i(301499),s=i(542634);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(i){return i===e||n(i,e,t)}}},716432:(e,t,i)=>{var n=i(690939),o=i(227361),s=i(379095),r=i(115403),a=i(689162),d=i(542634),l=i(240327);e.exports=function(e,t){return r(e)&&a(t)?d(l(e),t):function(i){var r=o(i,e);return void 0===r&&r===t?s(i,e):n(t,r,3)}}},882689:(e,t,i)=>{var n=i(829932),o=i(297786),s=i(267206),r=i(269199),a=i(571131),d=i(307518),l=i(285022),c=i(406557),u=i(701469);e.exports=function(e,t,i){t=t.length?n(t,(function(e){return u(e)?function(t){return o(t,1===e.length?e[0]:e)}:e})):[c];var h=-1;t=n(t,d(s));var p=r(e,(function(e,i,o){return{criteria:n(t,(function(t){return t(e)})),index:++h,value:e}}));return a(p,(function(e,t){return l(e,t,i)}))}},840371:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},379152:(e,t,i)=>{var n=i(297786);e.exports=function(e){return function(t){return n(t,e)}}},571131:e=>{e.exports=function(e,t){var i=e.length;for(e.sort(t);i--;)e[i]=e[i].value;return e}},626393:(e,t,i)=>{var n=i(733448);e.exports=function(e,t){if(e!==t){var i=void 0!==e,o=null===e,s=e==e,r=n(e),a=void 0!==t,d=null===t,l=t==t,c=n(t);if(!d&&!c&&!r&&e>t||r&&a&&l&&!d&&!c||o&&a&&l||!i&&l||!s)return 1;if(!o&&!r&&!c&&e<t||c&&i&&s&&!o&&!r||d&&i&&s||!a&&s||!l)return-1}return 0}},285022:(e,t,i)=>{var n=i(626393);e.exports=function(e,t,i){for(var o=-1,s=e.criteria,r=t.criteria,a=s.length,d=i.length;++o<a;){var l=n(s[o],r[o]);if(l)return o>=d?l:l*("desc"==i[o]?-1:1)}return e.index-t.index}},899291:(e,t,i)=>{var n=i(498612);e.exports=function(e,t){return function(i,o){if(null==i)return i;if(!n(i))return e(i,o);for(var s=i.length,r=t?s:-1,a=Object(i);(t?r--:++r<s)&&!1!==o(a[r],r,a););return i}}},301499:(e,t,i)=>{var n=i(689162),o=i(3674);e.exports=function(e){for(var t=o(e),i=t.length;i--;){var s=t[i],r=e[s];t[i]=[s,r,n(r)]}return t}},689162:(e,t,i)=>{var n=i(513218);e.exports=function(e){return e==e&&!n(e)}},542634:e=>{e.exports=function(e,t){return function(i){return null!=i&&(i[e]===t&&(void 0!==t||e in Object(i)))}}},139601:(e,t,i)=>{var n=i(840371),o=i(379152),s=i(115403),r=i(240327);e.exports=function(e){return s(e)?n(r(e)):o(e)}},189734:(e,t,i)=>{var n=i(121078),o=i(882689),s=i(105976),r=i(816612),a=s((function(e,t){if(null==e)return[];var i=t.length;return i>1&&r(e,t[0],t[1])?t=[]:i>2&&r(t[0],t[1],t[2])&&(t=[t[0]]),o(e,n(t,1),[])}));e.exports=a},467617:(e,t,i)=>{i.d(t,{e:()=>r,v:()=>a});var n=i(441143),o=i.n(n);class s{constructor(e,t){o()(e,"You must pass a requestContext to check an Experiment"),o()(t,"You must pass the name of the experiment to check"),this.requestContext=e,this.experimentName=t.toLowerCase()}_getGroup(e){return e?this.requestContext.experiments.v2ActivateExperiment(this.experimentName)||"":this.requestContext.experiments.v2GetGroup(this.experimentName)||""}}class r extends s{getGroup(e=!1){return this._getGroup(e)}}class a extends s{_isTreatment(e){return e.startsWith("enabled")||e.startsWith("employee")}enabled(){return this._isTreatment(this._getGroup(!0))}enabledWithNoActivation(){return this._isTreatment(this._getGroup(!1))}}},362038:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(324288),o=i(263116),s=i(785893);const r=(0,o.ZP)({resolved:{},chunkName:()=>"EditorWithMentionsInternal",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!!i.m[t]},importAsync:()=>Promise.all([i.e(89333),i.e(35978)]).then(i.bind(i,549075)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return i(t)},resolve(){return 549075}});function a(e){return(0,s.jsx)(r,{...e,fallback:(0,s.jsx)(n.Z,{})})}},324288:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(710159),o=i(883119),s=i(785893);function r(){const e=(0,n.ZP)();return(0,s.jsx)(o.kC,{alignItems:"center",justifyContent:"center",children:(0,s.jsx)(o.$j,{accessibilityLabel:e._("Loading editor","EditorWithMentionsFallback.loading","Message shown while waiting for the editor to load"),show:!0})})}},702962:(e,t,i)=>{i.d(t,{Z:()=>s});var n=i(883119),o=i(785893);function s(e){const{htmlFor:t,errorMessage:i}=e;return(0,o.jsx)(n.__,{htmlFor:t,children:(0,o.jsx)(n.xu,{marginTop:1,children:(0,o.jsx)(n.xv,{color:"error",size:"md",children:i})})})}},359488:(e,t,i)=>{i.d(t,{Z:()=>j});var n=i(667294),o=i(40142),s=i(698991),r=i(620831),a=i(263152),d=i(641914),l=i(625983),c=i(379771),u=i(456168),h=i(647637),p=i(424337),g=i(406335),m=i(689783),x=i(710159),_=i(883119),f=i(785893);function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y({board:e,hovered:t,searchQuery:i}){const n=e.privacy===r.Z.BoardPrivacy.SECRET;return(0,f.jsxs)(_.xu,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:[(0,f.jsx)(_.xu,{flex:"grow",children:(0,f.jsx)(_.xv,{weight:"bold",children:(0,p.W)(i,e.name)})}),(0,f.jsxs)(_.kC,{alignItems:"stretch",justifyContent:"start",direction:"row",flex:"none",children:[n&&(0,f.jsx)(s.Z,{type:"secret"}),e.is_collaborative&&(0,f.jsx)(s.Z,{type:"group"})]})]})}class b extends n.Component{constructor(e){super(e),v(this,"getSections",(()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return[];const{searchQuery:t}=this.state,{boardResource:{data:{all_boards:i}}}=this.props;return t.length>=2?[{items:(0,h.j)(i,t)}]:[{items:i}]})),v(this,"createBtnDisabled",(()=>{var e;if(null===(e=this.props.boardResource.data)||void 0===e||!e.all_boards)return!1;const{boardResource:{data:{all_boards:t}}}=this.props,{searchQuery:i}=this.state;return t.some((e=>{var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===i.toLowerCase()}))})),v(this,"handleBoardCreate",(e=>()=>{const{searchQuery:e}=this.state;if(!e)return;const{createBoard:t,invalidateBoardPickerBoardsResource:i,onBoardCreate:n}=this.props;i(),n?n(e):t({name:e,privacy:"public"}).then((e=>{const{onBoardChosen:t}=this.props;t(e)}))})),v(this,"handleBoardSelected",(e=>{this.props.onBoardChosen(e),this.setState({selectedBoard:e})})),v(this,"handleSearchQueryUpdate",(e=>{this.setState({searchQuery:e})})),v(this,"renderRow",(({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return(0,f.jsx)(y,{board:e,hovered:t,searchQuery:i})})),this.state={searchQuery:"",selectedBoard:e.board}}render(){const{boardResource:e,board:t,isBoardlessPinsBoard:i,isQuickCreatesBoard:n,isStoryPin:o,viewer:s}=this.props,{searchQuery:r,selectedBoard:d}=this.state;let l=this.props.i18n._("Select a board","Label for selecting a board in Edit Pin Modal","Label for selecting a board in Edit Pin Modal");return t?l=n?this.props.i18n._("Choose board","BoardPickerFlyout.displayBoardName.quickCreatesBoard","Title for board picker when current board is a quick creates board"):i?this.props.i18n._("Profile","BoardPickerFlyout.displayBoarName.boardlessPins","Title indicating the pin is saved to profile"):t.name:d&&(l=d.name),(0,f.jsxs)(_.xu,{children:[(0,f.jsx)(_.$j,{accessibilityLabel:this.props.i18n._("loading board picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!e.isLoaded}),e.data&&(0,f.jsx)(a.Z,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:l||"",isStoryPin:o,onCreate:this.handleBoardCreate(s),onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleBoardSelected,renderRow:this.renderRow,searchQuery:r,sections:this.getSections()})]})}}function j(e){const t=(0,d.Z)(),i=(0,x.ZP)(),n=(0,o.useDispatch)(),s=(0,u.Z)(),r=(0,o.useSelector)((({advertiser:e})=>e)),a=s.isAuth&&r&&r.owner_user_id!==s.id,h=a?r.id:null,p=a?r.owner_user_id:null,_=(0,l.Z)(),v=(0,g.Ms)(s,_),y=v||p,j=(0,c.Z)({name:"BoardPickerBoardsResource",options:{pin_id:e.pinId,field_set_key:"board_picker",onlyFetchBoards:!0,username:y,...h&&p?{advertiser_id:h,filter:"protected",username:p}:{}},noCache:!0});return(0,f.jsx)(b,{...e,advertiser_id:h,boardResource:j,createBoard:e=>t({boardCreateOptions:e}),invalidateBoardPickerBoardsResource:()=>{n((0,m.jB)("BoardPickerBoardsResource",{field_set_key:"board_picker",...v?{username:v}:{username:p}}))},username:p,viewer:s,i18n:i})}},263152:(e,t,i)=>{i.d(t,{Z:()=>p});var n=i(667294),o=i(69895),s=i(511931),r=i(885054),a=i(284355),d=i(710159),l=i(883119),c=i(785893);function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h extends n.Component{constructor(...e){super(...e),u(this,"state",{showFlyout:!1}),u(this,"setContainerRef",(e=>{this.containerRef=e})),u(this,"handleCreate",(()=>{this.hideFlyout();const{onCreate:e}=this.props;e&&e()})),u(this,"handleSelectItem",(e=>{this.hideFlyout();const{onSelect:t,onCreate:i}=this.props;e?t(e):i&&i()})),u(this,"handleDropdownTouch",(()=>{this.setState((e=>({showFlyout:!e.showFlyout})))})),u(this,"handleHideFlyout",(e=>{this.containerRef&&e.target instanceof HTMLElement&&!this.containerRef.contains(e.target)&&this.hideFlyout()})),u(this,"hideFlyout",(()=>{const{hoverHandlers:{onMouseLeave:e}}=this.props;e(),this.setState({showFlyout:!1})}))}componentDidMount(){document.addEventListener("click",this.handleHideFlyout,{capture:!0})}componentWillUnmount(){document.removeEventListener("click",this.handleHideFlyout,{capture:!0})}render(){const{dropdownValue:e,fetchMore:t,hoverHandlers:{onMouseOver:i,onMouseLeave:n},isHovering:a,isStoryPin:d,onCreate:u,onSearchQueryUpdate:h,renderRow:p,searchQuery:g,sections:m,createBtnDisabled:x}=this.props,{showFlyout:_}=this.state;this.indexManager=new o.Z(m.map((e=>e.items))),this.indexManager.setSelectItem(this.handleSelectItem);const f=!g.trim()||!!x;return(0,c.jsxs)(l.xu,{ref:this.setContainerRef,flex:d?"grow":void 0,children:[(0,c.jsx)(l.iP,{fullWidth:!!d,onMouseEnter:i,onMouseLeave:n,onTap:this.handleDropdownTouch,rounding:2,children:(0,c.jsxs)(l.xu,{alignItems:"center",color:a?"lightWash":"lightGray",direction:"row",display:"flex",flex:"grow",paddingX:4,paddingY:d?4:3,rounding:d?4:2,children:[(0,c.jsx)(l.kC,{alignItems:"stretch",justifyContent:"start",flex:"grow",children:(0,c.jsx)(l.xv,{weight:"bold",children:e})}),(0,c.jsx)(l.JO,{accessibilityLabel:"",color:"darkGray",icon:"arrow-down",size:14})]})}),_&&(0,c.jsx)(l.xu,{position:"relative",children:(0,c.jsxs)(l.xu,{borderStyle:"sm",color:"white",direction:"column",display:"flex",overflow:"hidden",position:"absolute",rounding:d?4:2,width:"100%",zIndex:new l.Ry(1),children:[(0,c.jsx)(l.xu,{children:(0,c.jsxs)(l.xu,{display:"flex",marginStart:-1,marginEnd:-1,padding:2,children:[(0,c.jsx)(l.xu,{display:"flex",flex:"grow",paddingX:1,children:(0,c.jsx)(s.Z,{hideIcon:!0,indexManager:this.indexManager,onChange:h,value:g})}),u&&(0,c.jsx)(l.xu,{paddingX:1,children:(0,c.jsx)(l.zx,{disabled:f,onClick:this.handleCreate,text:this.props.i18n._("Create","board or section dropdown create button","board or section dropdown create button")})})]})}),(0,c.jsx)(r.Z,{fetchMore:t,indexManager:this.indexManager,maxHeight:240,onSelectItem:this.handleSelectItem,renderItem:p,sections:m})]})})]})}}function p(e){const t=(0,d.ZP)(),{isHovering:i,hoverHandlers:n}=(0,a.Z)();return(0,c.jsx)(h,{...e,i18n:t,isHovering:i,hoverHandlers:n})}},701773:(e,t,i)=>{i.d(t,{Z:()=>f,x:()=>_});var n=i(667294),o=i(40142),s=i(149314),r=i(263152),a=i(379771),d=i(647637),l=i(424337),c=i(710159),u=i(883119),h=i(785893);function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const g="NO_SECTION_VALUE";function m({section:e,hovered:t,searchQuery:i}){return(0,h.jsxs)(u.xu,{children:[(0,h.jsx)(u.xu,{color:t?"lightGray":"white",display:"flex",padding:2,rounding:2,children:(0,h.jsx)(u.xu,{flex:"grow",children:(0,h.jsx)(u.xv,{weight:"bold",children:(0,l.W)(i,e.title)})})}),e.id===g&&(0,h.jsx)(u.iz,{})]})}class x extends n.Component{constructor(...e){super(...e),p(this,"state",{searchQuery:""}),p(this,"getPickerSections",(()=>{const{searchQuery:e}=this.state,{sectionsResource:t,mergingFromSectionId:i}=this.props;let n=t&&t.data||[];return n=i?n.filter((e=>e.id!==i)):[{id:g,title:this.props.i18n._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")},...n],e.length>=2&&(n=(0,d.j)(n,e,"title")),[{items:n}]})),p(this,"createBtnDisabled",(()=>{const{sectionsResource:e}=this.props,{searchQuery:t}=this.state;return!(!e||!e.data)&&e.data.some((e=>{var i;return(null===(i=e.title)||void 0===i?void 0:i.toLowerCase())===t.toLocaleLowerCase()}))})),p(this,"handleSectionCreate",(()=>{const{board:e,onSectionChange:t,sectionsResource:i,dispatch:n,onSectionCreate:o}=this.props,{searchQuery:r}=this.state;o?o(r):n&&e.id&&n((0,s.Z)({boardId:e.id,name:r},this.props.i18n)).then((e=>{i&&i.refresh(),this.setState({searchQuery:""}),t(e)}))})),p(this,"handleSectionSelected",(e=>{const{onSectionChange:t}=this.props;e.id===g?(t(null),this.setState({searchQuery:""})):(t(e),this.setState({searchQuery:""}))})),p(this,"handleSearchQueryUpdate",(e=>{this.setState({searchQuery:e})})),p(this,"renderRow",(({item:e,hovered:t})=>{const{searchQuery:i}=this.state;return(0,h.jsx)(m,{hovered:t,searchQuery:i,section:e})}))}componentDidUpdate(e){const t=e.selectedSectionId,{selectedSectionId:i}=this.props;if(i!==t){const{sectionsResource:e}=this.props;e&&e.refresh()}}render(){const{isStoryPin:e,sectionsResource:t,selectedSectionId:i,mergingFromSectionId:n,selectedSectionName:o}=this.props,{searchQuery:s}=this.state;let a=n?this.props.i18n._("Pick a section","default dropdown option for selecting a board section to merge to","default dropdown option for selecting a board section to merge to"):this.props.i18n._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit");if(i){let e;t&&t.data&&(e=t.data.find((e=>e.id===i))),a=e&&e.title||a}else o&&(a=o);return(0,h.jsxs)(u.xu,{children:[(0,h.jsx)(u.$j,{accessibilityLabel:this.props.i18n._("loading section picker","accessibility text for loading spinner","accessibility text for loading spinner"),show:!!t&&!t.isLoaded}),(!t||t&&t.isLoaded)&&(0,h.jsx)(r.Z,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:a,isStoryPin:e,onCreate:n?null:this.handleSectionCreate,onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleSectionSelected,renderRow:this.renderRow,searchQuery:s,sections:this.getPickerSections()})]})}}function _(e){const t=(0,c.ZP)();return(0,h.jsx)(x,{...e,dispatch:(0,o.useDispatch)(),i18n:t})}function f(e){const t=(0,a.Z)({name:"BoardSectionsRepinResource",options:{board_id:e.board.id},noCache:!0});return(0,h.jsx)(_,{...e,sectionsResource:t})}},911556:(e,t,i)=>{i.r(t),i.d(t,{CarouselSliders:()=>p,default:()=>g});var n=i(40142),o=i(613239),s=i(850770),r=i(710159),a=i(255948),d=i(531572),l=i(539195),c=i(883119),u=i(785893);const h={slider:{cursor:"pointer",padding:"30px 16px",position:"relative",zIndex:"105",pointerEvents:"auto"}},p=({addEllipsis:e,carouselIndex:t,carouselData:i,changeCarouselSlotIndex:n,handleCarouselSwipe:s,isShowingLastSlide:a,pin:p,pinId:g,contextLogData:m,viewParameter:x,viewType:_,componentType:f,isEditMode:v,forwardNode:y,backNode:b})=>{const j=(0,r.ZP)(),{logContextEvent:C}=(0,l.v)();if(!i)return null;const{carousel_slots:S=[],index:w=0}=i,k=void 0!==t?t:w,P=Math.max(0,k-1),E=Math.min(S.length-1,k+1),I=0===k,T=a||k===S.length-1,M=(e,t)=>{((e,t,i,n,o,s)=>{s||void 0===n||(e.preventDefault(),e.stopPropagation(),n(t,i)),void 0!==o&&o(i)})(e,g,t,n,s,v),((e,t,i,n,o,s,r,a,l,c,u)=>{if(!u||!s){const{carousel_slots:u,id:h}=s;e({event_type:108,object_id_str:i,component:l,view_type:a,view_parameter:r,event_data:{pinCarouselSlotEventData:{carouselSlotId:(null==u?void 0:u[n])&&Number(u[n].id),carouselDataId:Number(h),carouselSlotIndex:n,toCarouselSlotIndex:o}},aux_data:{...c,...(0,d.Kl)(t)||{}}})}})(C,p,g,k,t,i,x,_,f,m,v)};return(0,u.jsxs)(c.xu,{display:"flex",justifyContent:"between",position:"absolute",alignItems:"center",left:!0,right:!0,bottom:!0,top:!0,children:[(0,u.jsx)("div",{"data-test-id":"carousel-slider-left",role:"presentation",onClick:e=>{M(e,P)},onKeyUp:e=>{M(e,P)},style:h.slider,children:(0,u.jsx)(c.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{visibility:I?"hidden":"visible"}},display:"flex",height:"100%",justifyContent:"center",width:"100%",children:b||(0,u.jsx)(c.JO,{color:"white",icon:"arrow-back",accessibilityLabel:j._("View Previous","Button to advance carousel to the previous image","Button to advance carousel to the previous image")})})}),e&&(0,u.jsx)(o.default,{pinId:g,carouselIndex:t,carouselData:i,handleCarouselSwipe:s,variant:"default"}),(0,u.jsx)("div",{"data-test-id":"carousel-slider-right",role:"presentation",onClick:e=>{M(e,E)},onKeyUp:e=>{M(e,E)},style:h.slider,children:(0,u.jsx)(c.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{visibility:T?"hidden":"visible"}},display:"flex",height:"100%",justifyContent:"center",width:"100%",children:y||(0,u.jsx)(c.JO,{color:"white",icon:"arrow-forward",accessibilityLabel:j._("View Next","Button to advance carousel to the next image","Button to advance carousel to the next image")})})})]})},g=(0,n.connect)((({pins:e},{carouselData:t,pinId:i})=>{const n=e[i];return{pin:n,carouselData:t||(0,s.Z)({pin:n})}}),(e=>({changeCarouselSlotIndex:(t,i)=>e((0,a.yR)(t,i))})))(p)},588299:(e,t,i)=>{i.d(t,{ZP:()=>Re,Tr:()=>De,aU:()=>Te});var n=i(667294),o=i(40142),s=i(235198),r=i(150361),a=i.n(r),d=i(710159),l=i(883119),c=i(785893);function u({commentsDisabled:e,onCommentChange:t,onPhotoChange:i,photosDisabled:n,isManagedView:o,isNoTitle:s}){const r=(0,d.ZP)(),a=o?6:s?0:3;return(0,c.jsxs)(l.xu,{children:[!s&&(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:o?0:4,paddingY:a,children:[!o&&!s&&(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",children:r._("Comment Permissions","Label for comments setting on a pin in pin edit form","Label for comments setting on a pin in pin edit form")})}),(0,c.jsxs)(l.xu,{column:12,mdColumn:o?12:8,children:[(0,c.jsxs)(l.xu,{paddingY:1,display:"flex",alignItems:"center","data-test-id":"allow-comments-switch",children:[(0,c.jsx)(l.rs,{onChange:t,id:"CommentSwitch",switched:!e}),(0,c.jsx)(l.xu,{paddingX:2,children:(0,c.jsx)(l.__,{htmlFor:"CommentSwitch",children:(0,c.jsx)(l.xv,{size:"md",children:r._("Allow people to comment","Label for toggling comments on a pin in pin edit form","Label for toggling comments on a pin in pin edit form")})})})]}),i&&(0,c.jsxs)(l.xu,{paddingY:1,alignItems:"center",display:"flex",children:[(0,c.jsx)(l.rs,{onChange:i,id:"PhotoSwitch",switched:!n}),(0,c.jsx)(l.xu,{paddingX:2,children:(0,c.jsx)(l.__,{htmlFor:"PhotoSwitch",children:(0,c.jsx)(l.xv,{size:"md",children:r._("Allow people to upload photos","Label for toggling photos on a pin in pin edit form","Label for toggling photos on a pin in pin edit form")})})})]})]})]})]})}var h=i(620831),p=i(417294),g=i(724207),m=i(689783);var x=i(149314),_=i(618446),f=i.n(_),v=i(916389),y=i(258872),b=i(144977),j=i(647136),C=i(358142);function S(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class w extends n.PureComponent{constructor(...e){super(...e),S(this,"state",{deleting:!1}),S(this,"unmounted",!1),S(this,"handleConfirm",(()=>{if(this.state.deleting)return;const{onDeletePin:e}=this.props;this.setState({deleting:!0}),e().then((()=>this.handleDeleteDidComplete())).catch((e=>this.handleDeleteDidComplete(e)))})),S(this,"handleDeleteDidComplete",(e=>{const{toastManagerContext:t}=this.props;this.unmounted||this.setState({deleting:!1}),e||t.showToast((({onHide:e})=>(0,c.jsx)(j.ZP,{onHide:e,text:this.props.i18n._("Pin deleted!","User deleted their pin","User deleted their pin")})))}))}componentWillUnmount(){this.unmounted=!0}render(){const{i18n:e,onDismiss:t,showStoryPinCreatorDeleteMessage:i}=this.props,{deleting:n}=this.state;return(0,c.jsx)(v.ZP,{heading:e._("Are you sure?","Confirm the user wants to delete the pin","Confirm the user wants to delete the pin"),accessibilityModalLabel:e._("Are you sure you want to delete this pin?","Accessible label to confirm the user wants to delete the pin","Accessible label to confirm the user wants to delete the pin"),size:"sm",onDismiss:t,footer:(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"center",marginStart:-1,marginEnd:-1,children:[(0,c.jsx)(l.xu,{paddingX:1,children:(0,c.jsx)(l.zx,{fullWidth:!0,onClick:t,text:e._("Cancel"," - "," -- ")})}),(0,c.jsx)(l.xu,{paddingX:1,children:(0,c.jsx)(b.Z,{id:"confirm-delete-pin",children:(0,c.jsx)(y.Z,{color:"red",onClick:this.handleConfirm,text:e._("Delete","PinEditModal.DeletePinConfirmation.DeleteButton","Delete button to delete a Pin"),submitting:n})})})]}),children:(0,c.jsx)(l.xu,{padding:4,children:(0,c.jsx)(l.xv,{children:i?e._("If you delete this Pin, it'll be gone for good and those who've saved it won't be able to view it.","PinEditModal.DeletePinConfirmation","Confirmation to delete a Pin that lets the creator know it will be unavailable to other Pinners who have saved it"):e._("Once you delete a Pin, you can't undo it!"," - "," -- ")})})})}}function k(e){const t=(0,d.ZP)();return(0,c.jsx)(w,{...e,i18n:t,toastManagerContext:(0,C.F9)()})}function P({canEdit:e,onAltTextChange:t,altText:i}){const o=(0,d.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"AltTextField",children:(0,c.jsx)(l.xv,{size:"md",children:o._("Alt text","EditPinModal.EditAltText","Label for editing alt text of pin")})})}),(0,c.jsx)(l.xu,{column:12,mdColumn:8,children:e?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.nv,{id:"AltTextField",onChange:({value:e})=>t({value:e.slice(0,500)}),size:"lg",value:i||""})}),(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.__,{htmlFor:"AltTextField",children:(0,c.jsx)(l.xu,{marginTop:1,children:(0,c.jsx)(l.xv,{size:"md",color:"subtle",children:o._("This helps people using screen readers understand what your Pin is about.","EditPinModal.EditAltText","Label for editing alt text of pin")})})})})]}):(0,c.jsx)(l.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",weight:"bold",children:i})})})]})]})}var E=i(359488),I=i(565375);function T({board:e={},canEdit:t,isOriginallyQuickCreatesBoard:i,onBoardChange:n,onBoardCreate:o,viewerId:s}){const r=(0,d.ZP)(),{showEnabledSaveBehavior:a}=(0,I.ZP)(s),u="quick_saves"===e.layout&&a,h="quick_creates"===e.layout;return(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"BoardPicker",children:(0,c.jsx)(l.xv,{size:"md",children:i?r._("Organize to a board (optional)","editPinModal.editBoard.optionalBoardLabel","Label for board dropdown to select optional board"):r._("Board"," - "," -- ")})})}),t?(0,c.jsx)(l.xu,{column:12,mdColumn:8,"data-test-id":"edit-board",children:(0,c.jsx)(E.Z,{board:e,isBoardlessPinsBoard:u,isQuickCreatesBoard:h,onBoardChosen:n,onBoardCreate:o})}):e.name&&(0,c.jsx)(l.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",weight:"bold",children:e.name})})]})}var M=i(362038),D=i(702962),B=i(539195);function R(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class A extends n.Component{constructor(...e){super(...e),R(this,"state",{focused:!1}),R(this,"suggestionAnchorRef",(0,n.createRef)()),R(this,"handleBlur",(e=>{this.setState({focused:!1});const{onBlur:t}=this.props;t&&t(e)})),R(this,"handleFocus",(e=>{this.setState({focused:!0});const{onFocus:t}=this.props;t&&t(e)})),R(this,"handleChange",(({text:e,mentions:t})=>{this.props.onDescriptionChange({value:e,userMentionTags:t})}))}render(){const{canAddUserMentionTags:e,canEdit:t,description:i,errorMessage:o,initialMentions:s,label:r,placeholder:a,onDescriptionChange:d}=this.props,u={__style:{...this.state.focused?{boxShadow:"0 0 0 3px #92c2fb"}:{}}};return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"DescriptionField",children:(0,c.jsx)(l.xv,{size:"md",children:r})})}),t?(0,c.jsxs)(l.xu,{column:12,mdColumn:8,children:[(0,c.jsx)(l.xu,{children:e?(0,c.jsx)(l.xu,{borderStyle:"lg",dangerouslySetInlineStyle:u,id:"DescriptionField",minHeight:48,paddingX:2,paddingY:4,ref:this.suggestionAnchorRef,role:"textbox",rounding:4,children:(0,c.jsx)(M.Z,{initialMentions:s,initialText:i,onAddMention:()=>{this.props.logContextEvent({event_type:8905,element:116,aux_data:{tag_type:1}})},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onSearchMentionCancel:()=>{this.props.logContextEvent({event_type:8908,element:116,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:()=>{this.props.logContextEvent({event_type:8907,element:116,aux_data:{tag_type:1}})},maxSuggestions:4,placeholder:a})}):(0,c.jsx)(l.Kx,{id:"DescriptionField",placeholder:a,value:i,onChange:({value:e})=>{d({value:e,userMentionTags:[]})},hasError:(o||"").length>0})}),!!o&&(0,c.jsx)(l.xu,{children:(0,c.jsx)(D.Z,{errorMessage:o,htmlFor:"pin-edit-description"})})]}):(0,c.jsx)(l.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",weight:"bold",children:i})})]})]})}}const L=function(e){const{logContextEvent:t}=(0,B.v)();return(0,c.jsx)(A,{...e,logContextEvent:t})};var N=i(613239),Z=i(911556),F=i(440504);function z({isCarousel:e,onMouseEnter:t,onMouseLeave:i,shouldShowCarouselSliders:n,onCarouselSlide:o,currentIndex:s,carouselData:r,pinId:a,description:d,image:u={}}){return(0,c.jsxs)(l.xu,{paddingX:4,paddingY:3,children:[e&&(()=>{const e=r&&r.carousel_slots&&r.carousel_slots.length||1;return e>=2&&(0,c.jsx)(l.xu,{padding:2,children:(0,c.jsx)(l.__,{htmlFor:"CardsIndex",children:(0,c.jsxs)(l.xv,{size:"md",children:[s+1,"/",e]})})})})(),(0,c.jsx)(l.zd,{width:236,children:(0,c.jsxs)(l.xu,{onMouseEnter:t,onMouseLeave:i,children:[(0,c.jsxs)(l.zd,{rounding:2,wash:!0,children:[e&&n&&(0,c.jsx)(l.xu,{display:"inlineBlock",height:"100%",position:"absolute",width:"100%",zIndex:new l.Ry(10),dangerouslySetInlineStyle:{__style:{background:"rgba(0, 0, 0, 0.3)"}},children:(0,c.jsx)(Z.default,{handleCarouselSwipe:o,carouselIndex:s,carouselData:r,pinId:a,isEditMode:!0})}),e?(0,c.jsx)(F.Z,{carouselIndex:s,isCloseup:!1,carouselData:r,pinId:a,isEditMode:!0}):(0,c.jsx)(l.Ee,{alt:d,color:"#efefef",naturalHeight:u.height,src:u.url,naturalWidth:u.width})]}),e&&(0,c.jsx)(N.default,{carouselIndex:s,carouselData:r,pinId:a,handleCarouselSwipe:o,isEditMode:!0,variant:"legacy"})]})})]})}function O({apiErrorMessage:e,shouldShowGenericUpdateError:t,onClickDeleteButton:i,disableDelete:n,onHide:o,shouldDisableSave:s,triggerBoardAndSectionCreate:r}){const a=(0,d.ZP)();return(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[(0,c.jsx)(b.Z,{id:"delete-pin-button",children:(0,c.jsx)(l.zx,{fullWidth:!0,text:a._("Delete","EditPinModal.EditPinFooter.Delete","delete pin"),onClick:i,disabled:n})}),t&&(0,c.jsx)(l.xu,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:(0,c.jsx)(D.Z,{errorMessage:e||a._("Sorry! There was an error editing your Pin.","EditPinModal.EditPinFooter.ErrorMessageToast","Toast for pin edit error"),htmlFor:"pin-edit-generic-error"})}),(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[(0,c.jsx)(l.xu,{paddingX:2,children:(0,c.jsx)(l.zx,{fullWidth:!0,text:a._("Cancel","EditPinModal.EditPinFooter.Cancel","cancel changes"),onClick:o})}),(0,c.jsx)(l.xu,{paddingX:2,"data-test-id":"edit-pin-save",children:(0,c.jsx)(l.zx,{fullWidth:!0,text:a._("Save","EditPinModal.EditPinFooter.Save","save changes"),color:"red",onClick:r,disabled:s})})]})]})}function Y({pinNoteText:e,isCollaborative:t,onPinNoteChange:i}){const o=(0,d.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"PinNoteField",children:(0,c.jsx)(l.xv,{size:"md",children:t?o._("Note to group","editPinModal.editPinNote.groupTitle","Label for editing private note on group Pin"):o._("Note to self","editPinModal.editPinNote.title","Label for editing private note on Pin")})})}),(0,c.jsx)(l.xu,{column:12,mdColumn:8,paddingY:2,"data-test-id":"note-to-self-input",children:(0,c.jsx)(l.Kx,{errorMessage:e.length>=500?o._("Character limit reached","editPinModal.editPinNote.warningText","Text to inform user they have reached the length limit on Pin note"):void 0,id:"PinNoteField",onChange:i,placeholder:o._("Add a private note to remember your ideas about this Pin","editPinModal.editPinNote.placeholderText","Placeholder for editing private note"),value:e})})]})]})}var U=i(701773);function H({board:e,canEdit:t,currentSection:i,onSectionChange:n,onSectionCreate:o,sectionId:s,sectionName:r}){const a=(0,d.ZP)(),u=null!=e&&e.id?U.Z:U.x;return"quick_creates"===(null==e?void 0:e.layout)?null:(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:3,children:(0,c.jsx)(l.__,{htmlFor:"SectionPicker",children:(0,c.jsx)(l.xv,{size:"md",children:a._("Section","label for editing a Pin's board section","label for editing a Pin's board section")})})}),t&&e?(0,c.jsx)(l.xu,{column:12,mdColumn:8,children:(0,c.jsx)(u,{board:e,onSectionChange:n,selectedSectionId:s,selectedSectionName:r,onSectionCreate:o})}):(0,c.jsx)(l.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",weight:"bold",children:i&&!(e||{}).is_collaborative?i.title:a._("No section","default dropdown option for selecting a board section on pin edit","default dropdown option for selecting a board section on pin edit")})})]})}var V=i(246025);var W=i(541937);var G=i(860548),Q=i(87097),X=i(146083),K=i(297608);function $({keyValueBlocks:e,listBlocks:t,onUpdateKeyValueBlock:i,onUpdateListBlocks:o,templateType:s}){const r=(0,d.ZP)();return(0,c.jsxs)(l.xu,{children:[1===s&&(0,c.jsxs)(n.Fragment,{children:[(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:r._("Cook time","editModal.editStoryPinModal.details.cookTime","Label for cook time detail")}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(K.Z,{onUpdate:e=>i(0,e),value:e[0]||null})})]},"cooktime"),(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:r._("Servings","editModal.editStoryPinModal.details.servings","Label for serving size detail")}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(X.Z,{showLabel:!1,onUpdate:e=>i(1,e),value:e[1]||null})})]},"servingSize")]}),2===s&&(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:r._("Difficulty","editModal.editStoryPinModal.details.difficulty","Label for difficulty level detail")}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(G.Z,{showLabel:!1,onUpdate:e=>i(2,e),value:e[2]||null})})]},"difficulty"),(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:(()=>{switch(s){case 1:return r._("Ingredients","editModal.editStoryPinModal.listHeading","Heading for an ingredients list");case 2:return r._("Supplies","editModal.editStoryPinModal.listHeading","Heading for a supplies list");default:return r._("What they'll need","editModal.editStoryPinModal.listHeading","Heading for a generic list")}})()}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(Q.Z,{listBlocks:t,onUpdate:o})})]})]})}var q=i(123686),J=i(112978),ee=i(971415);const te=(0,o.connect)((()=>({})),(e=>({completeResourceFetch:t=>e((0,m.Sr)("PinResource",{field_set_key:"detailed",id:t.resource_response.data.id},t)),invalidatePin:t=>e((0,m.jB)("PinResource",{field_set_key:"detailed",id:t}))})))((function({apiErrorMessage:e,board:t,completeResourceFetch:i,commentsDisabled:o,description:s,disableDelete:r,invalidatePin:a,isLoadingPin:h,isProcessing:p,onChangeBoard:m,onChangeComment:x,onChangeSection:_,onClickBoardCreate:f,onClickDeleteButton:y,onClickEditPages:b,onClickSectionCreate:j,onHide:C,pinResource:S,sectionId:w,sectionName:k,title:P,triggerBoardAndSectionCreate:I}){var T,M,B,R,A,L,N,Z;const F=(0,d.ZP)(),z=null!==(T=S.data)&&void 0!==T?T:{},O=z.story_pin_data,Y=null!==(M=z.images&&z.images["474x"])&&void 0!==M?M:{},[H,G]=(0,n.useState)(!1),[Q,X]=(0,n.useState)(null),[K,te]=(0,n.useState)(!1),[ie,ne]=(0,n.useState)({}),[oe,se]=(0,n.useState)([]);(0,n.useEffect)((()=>{var e;const t=(null==O||null===(e=O.metadata)||void 0===e?void 0:e.basics)||null;if(t){const e=(0,W._i)(t);ne(e.keyValueBlocks||{}),se(e.listBlocks||[])}}),[O]),(0,n.useEffect)((()=>{e&&X(e)}),[e]);const{anyEnabled:re}=(0,J.aq)("web_story_pin_edit_deprecation"),ae=z.created_at?new Date(z.created_at):null,de=ae&&(0,V.Z)(ae,14),le=!re&&!!de&&new Date<de,ce=oe.length>0||Object.keys(ie).length>0,ue=(0,q.nk)(F._("Edit details and add, delete, or reorder pages up to {{ numDays }} days after your Idea Pin is published. Edit the board and engagement settings any time.","editModal.editStoryPinModal.editTimeInformation","Let the user know how the edit settings are limited"),{numDays:14});return(0,c.jsx)(v.ZP,{accessibilityModalLabel:F._("Edit your previously saved pin","editModal.editStoryPinModal.accessibilityLabel","Accessible label for edit previously saved story pin modal"),footer:(0,c.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"between",children:[(0,c.jsx)(l.xu,{"data-test-id":"delete-pin-button",children:(0,c.jsx)(l.zx,{fullWidth:!0,color:"white",disabled:r,onClick:y,size:"lg",text:F._("Delete","editModal.editStoryPinModal.deleteButton","Delete button for previously saved story pin")})}),!!Q&&(0,c.jsx)(l.kC,{alignItems:"stretch",justifyContent:"center",children:(0,c.jsx)(D.Z,{errorMessage:Q,htmlFor:"pin-edit-generic-error"})}),(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"between",marginEnd:-1,marginStart:-1,children:[(0,c.jsx)(l.xu,{paddingX:1,children:(0,c.jsx)(l.zx,{fullWidth:!0,onClick:C,size:"lg",text:F._("Cancel","editModal.editStoryPinModal.cancelButton","Cancel button to not save edits to previously saved story pin")})}),(0,c.jsx)(l.xu,{"data-test-id":"edit-pin-save",paddingX:1,children:(0,c.jsx)(l.zx,{fullWidth:!0,color:"red",onClick:()=>{if(H&&O){te(!0);const e=(0,W.Fe)({keyValueBlocks:ie,listBlocks:oe}),t=function(e){var t,i,n,o,s,r,a;return{metadata:{basics:null!==(t=e.metadata)&&void 0!==t&&t.basics?(0,W.CH)(e.metadata.basics):void 0,diy_data:null===(i=e.metadata)||void 0===i?void 0:i.diy_data,pin_image_signature:null===(n=e.metadata)||void 0===n?void 0:n.pin_image_signature,pin_title:null===(o=e.metadata)||void 0===o?void 0:o.pin_title,recipe_data:null===(s=e.metadata)||void 0===s?void 0:s.recipe_data,template_type:null===(r=e.metadata)||void 0===r?void 0:r.template_type},pages:(a=e.pages,(null!=a?a:[]).map((e=>{var t,i;const n=(null!==(t=e.blocks)&&void 0!==t?t:[]).map((e=>{switch(e.type){case"story_pin_paragraph_block":return{block_style:e.block_style,style:e.style,text:e.text,type:0};case"story_pin_heading_block":return{block_style:e.block_style,level:e.level,style:e.style,text:e.text,type:1};case"story_pin_image_block":return{block_style:e.block_style,image_signature:e.image_signature,tracking_id:e.tracking_id,type:2};case"story_pin_video_block":return{block_style:e.block_style,tracking_id:e.tracking_id,type:3,video_signature:e.video_signature};default:return null}})).filter(Boolean);return n.length>0?{blocks:n,layout:e.layout,style:null!==(i=e.style)&&void 0!==i&&i.background_color?{background_color:e.style.background_color}:void 0}:null})).filter(Boolean))}}(O),n={...t,metadata:{...t.metadata,basics:e}},o={pin_id:z.id,story_pin:JSON.stringify(n)};g.ZP.create("StoryPinEditResource",o).callUpdate().then((e=>{a(z.id),i(e),I()})).catch((e=>{X(e.message),te(!1)}))}else I()},size:"lg",text:F._("Done","editModal.editStoryPinModal.doneButton","Done button to save edits to previously saved story pin")})})]})]}),heading:F._("Edit Pin","editModal.editStoryPinModal.heading","Edit a previously saved story pin"),onDismiss:C,size:"md",children:h||!S.isLoaded||K||p?(0,c.jsx)(l.xu,{paddingX:12,paddingY:9,children:(0,c.jsx)(l.$j,{accessibilityLabel:F._("Loading edit information","editPinModal.editStoryPinModal.spinner","Accessible label for the edit pin loading icon"),show:!0})}):(0,c.jsx)(l.xu,{overflow:"hidden",children:(0,c.jsx)(l.xu,{marginEnd:-4,marginStart:-4,children:(0,c.jsxs)(l.xu,{display:"flex",minHeight:300,overflow:"hidden",paddingX:8,children:[(0,c.jsxs)(l.xu,{alignItems:"center",direction:"column",display:"flex",flex:"shrink",paddingX:4,children:[(0,c.jsxs)(l.zd,{wash:!0,rounding:4,width:120,children:[(0,c.jsx)(l.Ee,{alt:s,color:"#efefef",naturalHeight:null!==(B=Y.height)&&void 0!==B?B:1,naturalWidth:null!==(R=Y.width)&&void 0!==R?R:1,src:null!==(A=Y.url)&&void 0!==A?A:""}),(0,c.jsx)(l.xu,{position:"absolute",left:!0,top:!0,padding:2,children:(0,c.jsxs)(l.xu,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"center",opacity:.8,padding:2,rounding:"pill",children:[(0,c.jsx)(l.JO,{accessibilityLabel:F._("Idea Pin icon","editModal.editStoryPinModal.storyPinIndicator","Idea Pin icon indicator"),color:"darkGray",icon:"idea-pin",size:12}),(0,c.jsx)(l.xu,{marginStart:1,children:(0,c.jsx)(l.xv,{size:"md",weight:"bold",children:null===(L=z.story_pin_data)||void 0===L?void 0:L.page_count})})]})})]}),le?(0,c.jsx)(l.xu,{"data-test-id":"edit-pages-button",paddingY:2,children:(0,c.jsx)(l.zx,{onClick:b,text:F._("Edit pages","editModal.editStoryPinModal.editPagesButton","Edit pages label for story pin creation entry point")})}):null]}),(0,c.jsx)(l.xu,{direction:"column",display:"flex",flex:"grow",paddingX:4,children:(0,c.jsx)(l.xu,{marginBottom:-2,marginTop:-2,children:(0,c.jsx)(l.xu,{maxHeight:500,overflow:"auto",paddingX:1,children:(0,c.jsxs)(l.xu,{maxWidth:504,children:[de&&(0,c.jsx)(l.xu,{paddingY:2,children:le?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.xv,{size:"md",children:(0,q.nk)(F._("Edit until {{ editDate }}","editModal.editStoryPinModal.lastEditableDate","Let user know the last date this Pin can be edited on"),{editDate:(0,c.jsx)(ee.Z,{dateFormatType:ee.k.NUMERIC,useUTC:!1,value:de},`noEditsTwoWeeksAfter-${null!==(N=z.created_at)&&void 0!==N?N:""}`)})}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(l.xv,{color:"subtle",size:"md",children:ue})})]}):(0,c.jsxs)(l.xu,{children:[(0,c.jsx)(l.xv,{size:"md",children:F._("Editing","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",color:"subtle",children:F._("Only board selection and engagement settings can be changed!","editModal.editStoryPinModal.editLabel","Label header for informing users story pin is only editable for board selection")})})]})}),(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:F._("Title","editModal.editStoryPinModal.titleLabel","Label for form input where users will input the title of their pin")}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsxs)(l.xu,{alignItems:"center",color:"lightGray",display:"flex",justifyContent:"between",padding:4,rounding:4,children:[(0,c.jsx)(l.xv,{color:"subtle",lineClamp:1,children:P||""}),(0,c.jsx)(l.JO,{accessibilityLabel:F._("Lock","editModal.editStoryPinModal.lockIcon.accessibilityLabel","Label for the lock icon to show that editing a story pin title is locked"),color:"darkGray",icon:"lock"})]})})]}),(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:F._("Board","editModal.editStoryPinModal.boardLabel","Label for dropdown where users will choose their board")}),(0,c.jsx)(l.xu,{paddingY:2,children:t?(0,c.jsx)(E.Z,{board:t,isStoryPin:!0,onBoardChosen:m,onBoardCreate:f}):null})]}),(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:F._("Section","editModal.editStoryPinModal.sectionLabel","Label for dropdown where users will choose their section")}),(0,c.jsx)(l.xu,{paddingY:2,children:(null==t?void 0:t.id)&&(0,c.jsx)(U.Z,{isStoryPin:!0,board:t,onSectionChange:_,onSectionCreate:j,selectedSectionId:w,selectedSectionName:k})})]}),ce&&le&&(0,c.jsx)($,{keyValueBlocks:ie,listBlocks:oe,onUpdateKeyValueBlock:(e,t)=>{ne({...ie,[e]:t}),G(!0)},onUpdateListBlocks:e=>{se(e),G(!0)},templateType:null==O||null===(Z=O.metadata)||void 0===Z?void 0:Z.template_type}),z.can_delete_did_it_and_comments&&(0,c.jsxs)(l.xu,{paddingY:2,children:[(0,c.jsx)(l.xv,{size:"md",children:F._("Comments and photos permissions","editModal.editStoryPinModal.commentsAndPhotosPermissionsLabel","Label for dropdown where users can toggle off permissions for comments and photos")}),(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(u,{isNoTitle:!0,commentsDisabled:o,onCommentChange:x})})]})]})})})})]})})})})}));function ie({canEdit:e,onTitleChange:t,title:i,errorMessage:o}){const s=(0,d.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"TitleField",children:(0,c.jsx)(l.xv,{size:"md",children:s._("Title","Label for editing title of pin","Label for editing title of pin")})})}),(0,c.jsx)(l.xu,{column:12,mdColumn:8,children:e?(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.xu,{"data-test-id":"pin-title-input",children:(0,c.jsx)(l.nv,{hasError:(o||"").length>0,id:"TitleField",onChange:t,size:"lg",value:i})}),!!o&&(0,c.jsx)(l.xu,{children:(0,c.jsx)(D.Z,{errorMessage:o,htmlFor:"pin-edit-title"})})]}):(0,c.jsx)(l.xu,{column:12,mdColumn:8,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",weight:"bold",children:i})})})]})]})}function ne({onChangeWebsite:e,link:t,errorMessage:i}){const o=(0,d.ZP)();return(0,c.jsxs)(n.Fragment,{children:[(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"WebsiteField",children:(0,c.jsx)(l.xv,{size:"md",children:o._("Website"," - "," -- ")})})}),(0,c.jsxs)(l.xu,{column:12,mdColumn:8,children:[(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.nv,{hasError:(i||"").length>0,id:"WebsiteField",onChange:e,size:"lg",value:t})}),!!i&&(0,c.jsx)(l.xu,{children:(0,c.jsx)(D.Z,{errorMessage:i,htmlFor:"pin-edit-website"})})]})]})]})}var oe=i(662242),se=i(222421),re=i(379771);function ae({onShoppingRecChange:e,shoppingRecDisabled:t,storyPinData:i}){const o=(0,d.ZP)(),{isLoaded:s,data:r}=(0,re.Z)({name:"ApiResource",options:{url:"/v3/users/me/",data:{fields:"user.ip_stela_rec_disabled"}}});if(!s||!r)return null;const{has_product_pins:a}=i||{},u=r.ip_stela_rec_disabled;return(0,c.jsx)(n.Fragment,{children:(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,children:[(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",children:o._("Shopping recommendations","Heading for shopping recommendations permissions","shopping.recommendations")})}),(0,c.jsx)(l.xu,{column:12,mdColumn:8,children:(0,c.jsxs)(l.xu,{paddingY:1,display:"flex",alignItems:"start",children:[(0,c.jsx)(l.rs,{onChange:e,id:"PhotoSwitch",switched:!t,disabled:u||a}),(0,c.jsx)(l.xu,{paddingX:2,children:(0,c.jsx)(l.__,{htmlFor:"stelaSwitch",children:(0,c.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"start",direction:"column",children:[(0,c.jsx)(l.xv,{size:"md",color:u?"subtle":"default",children:o._("Show similar products ","Label to toggle similar products on ideal pin","ideaPin.stela.toggle")}),u?(0,c.jsxs)(l.xv,{color:"subtle",size:"md",children:[o._("You’ve disabled shopping recommendations for your profile ","Text indicating shopping recommendations are currently disabled","ideaPin.disable"),(0,c.jsx)(l.xv,{inline:!0,size:"md",weight:"bold",color:"subtle",children:(0,c.jsx)(l.rU,{inline:!0,href:"/settings/permissions",children:o._("Edit profile settings","Link to the settings page to enable shopping recommendations on idea pins","ideaPin.link")})})]}):(0,c.jsxs)(l.xu,{display:"flex",direction:"column",marginTop:1,children:[(0,c.jsx)(l.xu,{marginBottom:1,children:(0,c.jsx)(l.xv,{size:"md",children:o._("People can shop products similar to what’s shown in this Idea Pin using visual search","Text indicating shopping recommendations are currently enabled","ideaPin.enable")})}),(0,c.jsx)(l.xv,{size:"md",children:o._("Shopping recommendations aren’t available for Idea Pins with product or paid partnership tags","Explanation about how stela on idea pins with tagged products arent available","ideaPin.tagged.unavailable")})]})]})})})]})})]})})}function de({shoppingRecDisabled:e,onShoppingRecChange:t,isNoTitle:i}){const o=(0,d.ZP)();return(0,c.jsxs)(n.Fragment,{children:[!i&&(0,c.jsx)(l.iz,{}),(0,c.jsxs)(l.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:i?0:3,children:[!i&&(0,c.jsx)(l.xu,{column:12,mdColumn:3,paddingY:2,children:(0,c.jsx)(l.xv,{size:"md",children:o._("Recommendations","EditPinModal.recommendations","Title of a section in the edit pin modal to manage recommendations on a specific pin.")})}),(0,c.jsx)(l.xu,{column:12,mdColumn:8,children:(0,c.jsxs)(l.xu,{paddingY:1,display:"flex",alignItems:"center",children:[(0,c.jsx)(l.rs,{onChange:t,id:"ShoppingRecSwitch",switched:!e}),(0,c.jsx)(l.xu,{paddingX:2,children:(0,c.jsx)(l.__,{htmlFor:"ShoppingRecSwitch",children:(0,c.jsx)(l.xv,{size:"md",children:o._("Show shopping recommendations","EditPinModal.recommendations.showShoppingRecommendations.label","Label for toggling showing shopping recommendations on a specific pin.")})})})]})})]})]})}var le=i(625983),ce=i(211743),ue=i(456168),he=i(775858),pe=i(926842),ge=i(685894),me=i(816458),xe=i(152026),_e=i(69941),fe=i(926942),ve=i(672342),ye=i(891946),be=i(406335),je=i(952733),Ce=i(708206),Se=i(467617),we=i(248355),ke=i(151941),Pe=i(925927);function Ee(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ie(e){return Boolean(e&&e.trim().length)}function Te(e,t){const i=Ie(e),n=Ie(t);return(i||n)&&e!==t}class Me extends n.Component{constructor(...e){var t,i,n,o,s,r,d,l,c,u,p,m,x,_,v,y,b,j,C;super(...e),Ee(this,"state",{altText:(null===(t=this.props.pinResource.data)||void 0===t?void 0:t.alt_text)||"",board:(null===(i=this.props.pinResource.data)||void 0===i?void 0:i.board)||null,commentsDisabled:(null===(n=this.props.pinResource.data)||void 0===n?void 0:n.comments_disabled)||(null===(o=this.props.pinResource.data)||void 0===o?void 0:o.did_it_disabled)||!1,description:(null===(s=this.props.pinResource.data)||void 0===s||null===(r=s.description)||void 0===r?void 0:r.trim())||"",apiErrorMessage:null,link:(null===(d=this.props.pinResource.data)||void 0===d?void 0:d.link)||"",pinNoteText:(null===(l=this.props.pinResource.data)||void 0===l||null===(c=l.pin_note)||void 0===c?void 0:c.text)||"",sectionId:(null===(u=this.props.pinResource.data)||void 0===u||null===(p=u.section)||void 0===p?void 0:p.id)||null,sectionName:(null===(m=this.props.pinResource.data)||void 0===m||null===(x=m.section)||void 0===x?void 0:x.title)||null,showDeleteConfirmation:!1,carousel_data:(null===(_=this.props.pinResource.data)||void 0===_?void 0:_.carousel_data)||null,title:(null===(v=this.props.pinResource.data)||void 0===v?void 0:v.title)||"",isLoadingPin:!Boolean(this.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==this.props.carouselSlotCurrentIndex?this.props.carouselSlotCurrentIndex:(null===(y=this.props.pinResource.data)||void 0===y||null===(b=y.carousel_data)||void 0===b?void 0:b.index)||0,shoppingRecDisabled:null===(j=this.props.pinResource.data)||void 0===j?void 0:j.shopping_rec_disabled,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(C=this.props.pinResource.data)||void 0===C?void 0:C.user_mention_tags)||[]}),Ee(this,"onClickDeleteButton",(()=>this.setState({showDeleteConfirmation:!0}))),Ee(this,"onHideConfirmation",(()=>this.setState({showDeleteConfirmation:!1}))),Ee(this,"updateCarouselSlotIndex",(()=>{const{carouselSlotCurrentIndex:e}=this.props;this.setState({currentIndex:void 0!==e?e:this.props.pinResource.data&&this.props.pinResource.data.carousel_data&&this.props.pinResource.data.carousel_data.index||0})})),Ee(this,"handleBoardChange",(e=>{const{board:{id:t}}=this.state;e.id!==t&&this.setState({board:e,sectionId:null,sectionName:null})})),Ee(this,"createBoard",(e=>{const{createBoard:t,viewer:i,orbacActingAs:n}=this.props,{board:o}=this.state,s=(0,be.lJ)(i,n);!o.id&&o.name&&e&&t(o.name,e,s).then((e=>{if(this._isMounted){const{sectionId:t,sectionName:i}=this.state;!t&&i?(this.setState({board:e}),this.createSection()):(this.handleBoardChange(e),this.handleSave())}}))})),Ee(this,"handleBoardCreateClick",(e=>{if(!e)return;const t={name:e,privacy:h.Z.BoardPrivacy.PUBLIC,access:"write"};this.setState({board:t,sectionId:null,sectionName:null})})),Ee(this,"createSection",(()=>{const{board:e,sectionName:t}=this.state,{viewer:i,orbacActingAs:n}=this.props,o=(0,be.lJ)(i,n);if(!t)return;if(!e.id)return void this.createBoard();const s={boardId:e.id,name:t},{createSection:r}=this.props;r(s,o).then((e=>{this._isMounted&&(this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),this.handleSave())})).catch((()=>{this.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})}))})),Ee(this,"handleSectionCreateClick",(e=>{if(0===e.length)return;const{board:t}=this.state;t&&this.setState({sectionId:null,sectionName:e})})),Ee(this,"handleSectionChange",(e=>this.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1}))),Ee(this,"handleDeletePin",(()=>{const{advertiser_id:e,changeBoardPinCount:t,changeUserPinCount:i,dispatch:n,onDelete:o,onHide:s,orbacActingAs:r,pinId:a,pinResource:{data:d},removeBoardlessPin:l,viewer:c}=this.props,u=(0,be.lJ)(c,r),h={...e?{advertiser_id:e}:{},...u?{orbac_subject_id:u}:Object.freeze({}),id:a};return g.ZP.create("PinResource",h).callDelete().then((()=>{if(this._isMounted){if(!d)return;const{board:{id:e}={},pinner:{id:r}={},section:l}=d,c=null==l?void 0:l.id;t({boardId:e,sectionId:c,increment:-1}),i({userId:r,increment:-1}),n((0,xe.xQ)(e)),n((0,se.Z)({feedId:c||e,feedType:c?me.DV.SECTION_PINS:me.DV.BOARD_PINS,itemIds:[a],itemType:"pin"})),n((0,se.Z)({feedId:r,feedType:me.DV.CREATED_TAB_STORY_PINS_FEED,itemIds:[a],itemType:"pin"})),n((0,se.Z)({feedId:r,feedType:me.DV.CREATED_TAB_ACTIVITY_PINS_FEED,itemIds:[a],itemType:"pin"})),c&&n((0,oe.Z)(c)),s(),o&&o()}c.id&&l(c.id,a)}))})),Ee(this,"sanitizeCarouselData",(e=>{let{carousel_data:t}=this.state;if(e&&(t=e),t){const{carousel_slots:e}=t;if(e){const t={carousel_slots:[]};return e.forEach((e=>{const i={};i.description=e.details||"",i.title=e.title||"",i.link=e.link||"",t.carousel_slots.push(i)})),t}}return null})),Ee(this,"triggerBoardAndSectionCreate",(e=>()=>{const{board:t,sectionId:i,sectionName:n}=this.state;t&&!t.id&&t.name?this.createBoard(e):!i&&n?this.createSection():this.handleSave()})),Ee(this,"logPinEditEvent",((e,t,i,n,o)=>{const s={},{pinId:r,view:a,viewParameter:d}=this.props,{userMentionTags:l}=this.state;if(s.objectId=r,s.num_user_mention_tags=l.length,e&&(s.board_was_modified=!0),!e&&t&&(s.board_section_was_modified=!0),i){const{description:e}=this.state,{description:t}=o;s.original_pin_description=t,s.edited_pin_description=e}if(n){const{carousel_data:e}=this.state,{carousel_data:t}=o;s.original_carousel_data=JSON.stringify(this.sanitizeCarouselData(t)),s.edited_carousel_data=JSON.stringify(this.sanitizeCarouselData(e))}this.props.logContextEvent({event_type:2,component:208,view_type:a,view_parameter:d,aux_data:{...s}})})),Ee(this,"handleSave",(()=>{this.setState({apiErrorMessage:null,isProcessing:!0});const{advertiser_id:e,completeResourceFetch:t,invalidatePinResource:i,orbacActingAs:n,pinId:o,pinResource:{data:s},onHide:r,removeBoardlessPin:a,updatePinNote:d,viewer:l}=this.props;if(!s)return;const{alt_text:c,board:u,comments_disabled:h,did_it_disabled:p,title:m,description:x,link:_,pin_note:v,section:y,carousel_data:b,shopping_rec_disabled:j}=s,C=null==v?void 0:v.text,{carousel_data:S,shouldShowValidationLinkFormatError:w}=this.state;let k;if(S){const e=this.sanitizeCarouselData();e&&(k=JSON.stringify(e))}const{altText:P,board:E,commentsDisabled:I,currentIndex:T,title:M,description:D,pinNoteText:B,sectionId:R,shoppingRecDisabled:A,carousel_data:L,userMentionTags:N}=this.state,Z=E||u,F=w?_:this.state.link,z=(0,be.lJ)(l,n),O={alt_text:P,board_id:null==Z?void 0:Z.id,board_section_id:R,carousel_data_json:k,description:D,disable_comments:I,disable_did_it:I,id:o,link:F,shopping_rec_disabled:A,title:M,user_mention_tags:JSON.stringify(N),...e?{advertiser_id:e}:{},...z?{orbac_subject_id:z}:Object.freeze({})},Y=y&&y.id||null,U=null==Z?void 0:Z.id,H=null==u?void 0:u.id,V=Te(c,P),W=H!==U,G=(Boolean(Y)||Boolean(R))&&Y!==R,Q=Te(m,M),X=Te(x,D),K=Te(_,F),$=Boolean(L)&&Boolean(b)&&!f()(L,b),q=h!==I||p!==I,J=Te(C,B);V||W||G||Q||X||J||K||$||q||j!==A?(J&&d(o,C,B,z),g.ZP.create("PinResource",O).callUpdate().then((e=>{if(this._isMounted){var n;const{changeBoardPinCount:c,onSubmit:u,pinId:h,pinMoved:p}=this.props;var o,d;if((W||G)&&U&&H)p({selectedPinIds:[h],source:{boardId:H,sectionId:Y},target:{boardId:U,sectionId:R}}),c({boardId:U,sectionId:R||void 0,increment:1}),c({boardId:H,sectionId:Y||void 0,increment:-1}),l.id&&"quick_saves"===(null===(o=s.board)||void 0===o?void 0:o.layout)&&a(l.id,h);if(u&&U&&null!=Z&&Z.url)u({boardId:U,title:null!==(d=Z.name)&&void 0!==d?d:"",sectionId:R,url:Z.url});r(),i(h,z),null!==(n=e.resource_response)&&void 0!==n&&n.data.carousel_data&&(e.resource_response.data.carousel_data.index=T),t(e,z),this.logPinEditEvent(W,G,X,$,s)}})).catch((()=>{const{shouldShowValidationTitleError:e,shouldShowValidationDescriptionError:t,shouldShowValidationLinkFormatError:i}=this.state;this.setState({isProcessing:!1,shouldShowGenericUpdateError:!e&&!t&&!i})}))):(r(),i(o,z)),this.setState({isProcessing:!1})})),Ee(this,"handleTextChanges",((e,t)=>{const{carousel_data:i}=this.state;if(!i)return;const n=a()(i),{carousel_slots:o=[]}=n,{currentIndex:s,shouldApplyTextToAll:r,description:d,link:l,title:c}=this.state,u=this.valueIsValidForType(e,t);switch(r?o.forEach((i=>i[t]=e)):o[s]&&(o[s][t]=e),t){case"details":const t=0===s?e:d;this.setState({description:t,carousel_data:n||null,shouldShowValidationDescriptionError:!u,shouldShowGenericUpdateError:!1});break;case"link":const i=0===s?e:l;this.setState({link:i,carousel_data:n||null,shouldShowValidationLinkFormatError:!u,shouldShowGenericUpdateError:!1});break;case"title":const o=0===s?e:c;this.setState({title:o,carousel_data:n||null,shouldShowValidationTitleError:!u,shouldShowGenericUpdateError:!1})}})),Ee(this,"handleDescriptionChange",(({value:e,userMentionTags:t})=>{const i=this.valueIsValidForType(e,"description"),n=this.valueIsValidForType(t,"userMentionTags");t.length<this.state.userMentionTags.length&&this.props.logContextEvent({event_type:8906,element:116,aux_data:{tag_type:1}}),this.setState({description:e,userMentionTags:t,shouldShowValidationDescriptionError:!i,shouldShowValidationUserMentionTagsError:!n,shouldShowGenericUpdateError:!1})})),Ee(this,"handleCarouselDetailsChange",(({value:e})=>{this.handleTextChanges(e,"details")})),Ee(this,"handleTitleChange",(({value:e})=>{const t=this.valueIsValidForType(e,"title");this.setState({title:e,shouldShowValidationTitleError:!t,shouldShowGenericUpdateError:!1})})),Ee(this,"handleCarouselTitleChange",(({value:e})=>{this.handleTextChanges(e,"title")})),Ee(this,"handleAltTextChange",(({value:e})=>{this.setState({altText:e})})),Ee(this,"valueIsValidForType",((e,t)=>{switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===(0,we.FU)([(0,we.Jx)({message:this.props.i18n._("Not a valid url.","Validation error for an improperly formated url","Validation error for an improperly formated url")})],e).length;case"title":return e.length<=100;case"userMentionTags":return e.length<=5;default:return!0}})),Ee(this,"handleWebsiteChange",(({value:e})=>{const t=this.valueIsValidForType(e,"link");this.setState({link:e,shouldDisableSave:!t,shouldShowValidationLinkFormatError:!t,shouldShowGenericUpdateError:!1})})),Ee(this,"handleCarouselWebsiteChange",(({value:e})=>{this.handleTextChanges(e,"link")})),Ee(this,"handleCommentChange",(e=>this.setState({commentsDisabled:!e.value}))),Ee(this,"handleShoppingRecChange",(e=>{this.setState({shoppingRecDisabled:!e.value})})),Ee(this,"handleShouldApplyToAll",(e=>{if(e){const{currentIndex:t=0,carousel_data:i}=this.state;if(!i)return;const n=a()(i),{carousel_slots:o=[]}=n,{details:s,link:r,title:d}=o[t];o.forEach((e=>{e.details=s,e.title=d,e.link=r})),this.setState({carousel_data:n,shouldApplyTextToAll:e})}else this.setState({shouldApplyTextToAll:e})})),Ee(this,"handleCarouselSlider",(e=>{const{carousel_data:t}=this.state,i=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<i&&this.setState({currentIndex:e})})),Ee(this,"handleClickStoryPinPages",(()=>{const{pinResource:{data:e},history:t}=this.props;e&&t.push(`/idea-pin-builder/${e.id}/edit`)})),Ee(this,"handleMouseEnter",(()=>{this.setState({shouldShowCarouselSliders:!0})})),Ee(this,"handleMouseLeave",(()=>{this.setState({shouldShowCarouselSliders:!1})}))}componentDidMount(){this._isMounted=!0,this.updateCarouselSlotIndex()}componentDidUpdate(e){const{pinResource:{data:t,isLoaded:i},carouselSlotCurrentIndex:n}=this.props;var o;t&&i!==e.pinResource.isLoaded&&this.setState({altText:t.alt_text,board:t.board,commentsDisabled:t.comments_disabled||t.did_it_disabled,description:t.description&&t.description.trim(),isLoadingPin:!1,link:t.link,pinNoteText:(null===(o=t.pin_note)||void 0===o?void 0:o.text)||"",sectionId:(t.section||{}).id,sectionName:(t.section||{}).title,title:t.title,carousel_data:t.carousel_data,currentIndex:void 0!==n?n:t.carousel_data&&t.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:t.user_mention_tags||[],shoppingRecDisabled:t.shopping_rec_disabled})}componentWillUnmount(){this._isMounted=!1}getCurrentUserId(e){return e.isAuth?e.id:""}render(){var e,t,i;const{disableDelete:n,onHide:o,orbacActingAs:r,pinResource:a,pinId:d,requestContext:h,viewer:p}=this.props,{experiments:g}=h,{altText:m,apiErrorMessage:x,board:_,commentsDisabled:f,description:y,link:b,pinNoteText:j,sectionId:C,sectionName:S,showDeleteConfirmation:w,title:E,isLoadingPin:I,isProcessing:M,carousel_data:D,shouldApplyTextToAll:B,currentIndex:R,shoppingRecDisabled:A,shouldDisableSave:N,shouldShowCarouselSliders:Z,shouldShowValidationTitleError:F,shouldShowValidationDescriptionError:U,shouldShowValidationLinkFormatError:V,shouldShowGenericUpdateError:W,shouldShowValidationUserMentionTagsError:G,userMentionTags:Q}=this.state,X=a.data||{},K=!!(X&&X.story_pin_data_id&&X.story_pin_data),$=(null===(e=X.native_creator)||void 0===e?void 0:e.id)===this.getCurrentUserId(p);if(w)return(0,c.jsx)(k,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation,showStoryPinCreatorDeleteMessage:K&&$});const q=!!(D&&D.carousel_slots&&D.carousel_slots.length>1),J=D&&D.carousel_slots&&D.carousel_slots.length>0&&D.carousel_slots[R]||{},{details:ee="",link:oe="",title:se=""}=J,re=X&&(X.access||[]).includes("write")||this.props.canEdit||!!_&&(0,s.Z)({action:4,board:_,viewer:p})||!!_&&(0,be.KY)(p,_,r),le=e=>{const t=(0,be.lJ)(e,r),i=t||this.getCurrentUserId(e),n=this.props.canEdit&&this.props.advertiserOwnerUserId?this.props.advertiserOwnerUserId:i;return re&&!X.is_repin&&!K&&(q||!D)&&(X.native_creator&&X.native_creator.id===n||q&&X.pinner&&X.pinner.id===n||X.link_domain&&X.link_domain.official_user&&X.link_domain.official_user.id===n||!!X.domain&&X.pinner&&X.pinner.id===n&&X.pinner.domain_url&&X.pinner.domain_url.includes(X.domain))},ce=X&&X.images&&X.images["474x"]||{},ue=new Se.v(h,"web_story_pin_creator").enabledWithNoActivation(),he=new Se.v(h,"web_alt_text").enabledWithNoActivation(),me=!new Se.e(h,"web_ip_stela_opt_in").getGroup().includes("pwt")&&new Se.v(h,"web_ip_stela_opt_in").enabled(),xe=K&&!!X.story_pin_data&&me&&$,_e=X.story_pin_data&&X.story_pin_data.metadata&&X.story_pin_data.metadata.version?(0,pe.n)(X.story_pin_data.metadata.version,ge.RR):null,fe=null!=_e&&_e>=0,ve=!!X.story_pin_data&&!!X.story_pin_data.metadata&&!!X.story_pin_data.metadata.is_editable&&X.native_creator&&X.native_creator.id===this.getCurrentUserId(p);if(K&&ue&&fe&&ve)return(0,c.jsx)(te,{apiErrorMessage:x,board:_,commentsDisabled:f,description:y,disableDelete:!re||n,isLoadingPin:I,isProcessing:M,onChangeBoard:this.handleBoardChange,onChangeComment:this.handleCommentChange,onChangeSection:this.handleSectionChange,onClickBoardCreate:this.handleBoardCreateClick,onClickDeleteButton:this.onClickDeleteButton,onClickEditPages:this.handleClickStoryPinPages,onClickSectionCreate:this.handleSectionCreateClick,onHide:o,pinResource:a,sectionId:C,sectionName:S,title:E,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(p.username&&p.username)});const je=le(p)?(0,c.jsx)(ie,{canEdit:re,onTitleChange:q?this.handleCarouselTitleChange:this.handleTitleChange,title:q&&se?se:E,errorMessage:F?(0,ye.Y8)(q,this.props.i18n):""}):null,Ce=(re||p.isAuth&&(X.pinner||{}).id===p.id)&&le(p)?(0,c.jsx)(L,{canAddUserMentionTags:!q,canEdit:re,description:(q?ee:y)||"",errorMessage:(()=>U?(0,ye.MM)(q,this.props.i18n):G?(0,ye.bl)(q,this.props.i18n):"")(),initialMentions:Q,label:this.props.i18n._("Description","Label for editing description","Label for editing description"),placeholder:this.props.i18n._("Tell us about this Pin...","Placeholder for editing description","Placeholder for editing description"),onDescriptionChange:q?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,we=(0,c.jsx)(Y,{isCollaborative:!(null==_||!_.is_collaborative),onPinNoteChange:({value:e})=>{this.setState({pinNoteText:e})},pinNoteText:j}),ke=(e=>le(e)&&!(X.aggregated_pin_data&&X.aggregated_pin_data.is_shop_the_look))(p)?(0,c.jsx)(ne,{link:q&&oe?oe:b,onChangeWebsite:q?this.handleCarouselWebsiteChange:this.handleWebsiteChange,errorMessage:V?(0,ye.qj)(q,this.props.i18n):""}):null,Pe=q?(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[(0,c.jsx)(l.xu,{paddingY:2,children:(0,c.jsx)(l.__,{htmlFor:"applyTextToAll",children:(0,c.jsx)(l.xv,{children:this.props.i18n._("Apply text to all","Apply title, description, link to all cards","Apply title, description, link to all cards")})})}),(0,c.jsx)(l.xu,{paddingX:2,paddingY:2,children:(0,c.jsx)(l.rs,{onChange:e=>this.handleShouldApplyToAll(e.value),id:"applyTextToAll",switched:B})})]}):null,Ee=le(p)&&he?(0,c.jsx)(P,{canEdit:re,onAltTextChange:this.handleAltTextChange,altText:m}):null,Ie=X.can_delete_did_it_and_comments?(0,c.jsx)(u,{commentsDisabled:f,onCommentChange:this.handleCommentChange}):null,Te=g.getWithoutActivation("web_shopping_rec_setting").group;Te.match("pwt")||g.v2ActivateExperiment("web_shopping_rec_setting");const Me=!["enabled","employees"].includes(Te)||!p.isAuth||(null===(t=X.pinner)||void 0===t?void 0:t.id)!==p.id||X.is_repin||X.story_pin_data||p.shopping_rec_disabled?null:(0,c.jsx)(de,{shoppingRecDisabled:A,onShoppingRecChange:this.handleShoppingRecChange}),De=!!p.has_quicksave_board&&!!p.boardCount&&p.boardCount<2,Be="quick_creates"===(null===(i=X.board)||void 0===i?void 0:i.layout),Re=(0,be.Ms)(p,r);return(0,c.jsx)(v.ZP,{heading:this.props.i18n._("Edit this Pin","EditPinModal.ModalHeading.EditThisPin","Edit a previously saved pin"),accessibilityModalLabel:this.props.i18n._("Edit your previously saved pin","EditPinModal.ModalHeading.AccessibleLabel","Accessible label for edit previously saved pin modal"),size:De?"sm":"lg",onDismiss:o,footer:(0,c.jsx)(O,{apiErrorMessage:x,shouldShowGenericUpdateError:W,onClickDeleteButton:this.onClickDeleteButton,disableDelete:!re||n,onHide:o,shouldDisableSave:N,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(Re)}),children:I||!a.isLoaded||M?(0,c.jsx)(l.kC,{alignItems:"center",justifyContent:"center",children:(0,c.jsx)(l.$j,{accessibilityLabel:this.props.i18n._("loading","EditPinModal.LoadingPin.Spinner","Accessible label for the edit pin loading icon"),show:!0})}):(0,c.jsxs)(l.xu,{display:"flex",justifyContent:De?"center":"between",minHeight:350,paddingX:4,children:[De?null:(0,c.jsxs)(l.xu,{column:12,mdColumn:9,children:[(0,c.jsx)(T,{board:_||X.board,canEdit:re,isOriginallyQuickCreatesBoard:Be,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick,viewerId:p.id||""}),(0,c.jsx)(H,{board:_||X.board,canEdit:re,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:C,sectionName:S,currentSection:X.section}),je,Ce,ke,Pe,Ee,we,Ie,Me,xe&&(0,c.jsx)(ae,{onShoppingRecChange:this.handleShoppingRecChange,shoppingRecDisabled:A,storyPinData:X.story_pin_data})]}),(0,c.jsx)(z,{isCarousel:q,shouldShowCarouselSliders:Z,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:d,description:y,image:ce})]})})}}const De=(e,t,i)=>({field_set_key:"detailed",id:e,preserve_component_state:t,...i?{orbac_subject_id:i}:Object.freeze({})}),Be=(0,o.connect)(null,((e,t)=>({changeBoardPinCount:t=>e((0,he.B)(t)),changeUserPinCount:t=>e((0,fe.J)(t)),completeResourceFetch:(t,i)=>e((0,m.Sr)("PinResource",De(t.resource_response.data.id,!1,i),t)),createBoard:(t,i,n)=>e(function(e,t,i){const n={name:e,privacy:h.Z.BoardPrivacy.PUBLIC,username:t,...i?{orbac_subject_id:i}:Object.freeze({})};return e=>g.ZP.create("BoardResource",n).callCreate().then((i=>{const n=i.resource_response.data;return e(t&&(0,m.jB)("BoardsResource",(0,p.Z)(t,!1))),n}))}(t,i,n)),createSection:(i,n)=>e((0,x.Z)(i,t.i18n,n)),invalidatePinResource:(t,i)=>e((0,m.jB)("PinResource",De(t,!0,i))),removeBoardlessPin:(t,i)=>e((0,se.Z)({feedId:t,feedType:me.DV.BOARDLESS_PINS,itemIds:[i],itemType:"pin"})),pinMoved:(0,Ce.bindActionCreators)(ke.S,e),updatePinNote:(t,i,n,o)=>e((0,_e._)(t,i,n,o))})))(Me);function Re(e){var t;const i=(0,d.ZP)(),{logContextEvent:n}=(0,B.v)(),s=(0,o.useSelector)((({advertiser:e})=>e)),r=null===(t=(0,ve.W)())||void 0===t?void 0:t.onPinDelete,a=(0,le.Z)(),l=(0,ue.Z)(),u=(0,be.lJ)(l,a),h=(0,re.Z)({name:"PinResource",options:De(e.pinId,!0,u)}),p=l.isAuth&&Boolean(s)?s.id:void 0,g=l.isAuth&&Boolean(s)&&s.owner_user_id!==l.id?s.owner_user_id:void 0,m=(0,ce.Z)(h.data);return(0,c.jsx)(Be,{...e,dispatch:(0,o.useDispatch)(),history:(0,Pe.k6)(),pinResource:h,requestContext:(0,je.B)(),i18n:i,onDelete:()=>{var t;m(),null===(t=e.onDelete)||void 0===t||t.call(e),r&&r({pinId:e.pinId})},orbacActingAs:a,advertiser_id:p,advertiserOwnerUserId:g,viewer:l,logContextEvent:n})}},891946:(e,t,i)=>{function n(e,t){return e?t._("Title too long. Make sure all cards' titles have less than 100 characters","Title entered is too long while editing a carousel pin and/or one of its pins","Title entered is too long while editing a carousel pin and/or one of its pins"):t._("Title too long. Make sure title has less than 100 characters","Title entered is too long while editing a pin","Title entered is too long while editing a pin")}function o(e,t){return e?t._("Description too long. Make sure all cards' descriptions have less than 500 characters","Description entered is too long while editing a carousel pin and/or one of its pins","Description entered is too long while editing a carousel pin and/or one of its pins"):t._("Description too long. Make sure description has less than 500 characters","Description entered is too long while editing a pin","Description entered is too long while editing a pin")}function s(e,t){return t._("Too many mentions. Make sure you have at most 5.","editPinModal.errorMessages.userMentionOverLimit","Too many mentions used in the description")}function r(e,t){return e?t._("Need to provide a valid URL. Make sure all cards' links are valid","Invalid URL/link provided while editing a carousel pin and/or one of its pins","Invalid URL/link provided while editing a carousel pin and/or one of its pins"):t._("Need to provide a valid URL. Make sure the link is valid","Invalid URL/link provided while editing a pin","Invalid URL/link provided while editing a pin")}i.d(t,{MM:()=>o,Y8:()=>n,bl:()=>s,qj:()=>r})},860548:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(710159),o=i(883119),s=i(785893);function r({onUpdate:e,showLabel:t=!0,value:i}){const r=(0,n.ZP)(),a=[{label:r._("Easy","storyboard.detailsList.field.difficulty","Easy difficulty rating for story pin"),value:String(1)},{label:r._("Medium","storyboard.detailsList.field.difficulty","Medium difficulty rating for story pin"),value:String(2)},{label:r._("Difficult","storyboard.detailsList.field.difficulty","Hard difficulty rating for story pin"),value:String(3)}];return(0,s.jsx)(o.kC,{alignItems:"stretch",justifyContent:"start",width:"100%",children:(0,s.jsx)(o.xu,{width:"100%",children:(0,s.jsx)(o.EI,{size:"lg",id:"servings",name:"servings",label:t?r._("Difficulty","storyboard.detailsList.field.difficulty","Header title for difficulty rating entry for story pin"):void 0,placeholder:r._("Pick a difficulty rating","storyboard.detailsList.field","Placeholder caption for difficulty rating input in story pin"),value:i,options:a,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},87097:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(667294),o=i(76814),s=i(710159),r=i(883119),a=i(785893);const d=e=>{const t=e.split("\n");t.push("");const i=[];let n,o=[];return t.forEach((e=>{const t=e.indexOf("•");t>-1?(n||(n=""),o.push(e.substring(t+1).trim())):((n||o.length>0)&&i.push({heading:n,items:o}),n=e,o=[])})),i},l=e=>{let t="";return e.forEach(((i,n)=>{const{heading:o,items:s}=i;o&&(t+=o),s&&s.length>0&&(t+="\n• "+s.join("\n• ")),n<e.length-1&&(t+="\n\n")})),t};const c=function({header:e,helperText:t,listBlocks:i,onUpdate:c,placeholderListBlocks:u}){const h=(0,s.ZP)(),p=l(u||[{heading:h._("What you'll need","storyboard.detailsList.placeholder","Placeholder text header for details list of story Pin"),items:[h._("Write a bullet list of tools, materials and anything else!","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin"),h._("Type it up or copy and paste.","storyboard.detailsList.placeholder","Placeholder text instructions for details list of story Pin")]}]),[g,m]=(0,n.useState)(i?l(i):"");return(0,a.jsx)(r.xu,{children:(0,a.jsx)(r.Kx,{id:"storyboard-details-list",helperText:t,label:e,onChange:({value:e})=>{m(e),c(d(e))},onBlur:()=>{""===g.trim()&&m("")},onKeyDown:({event:e,value:t})=>{const{keyCode:i,target:n,shiftKey:s}=e;if(n instanceof HTMLTextAreaElement){const{selectionStart:r,selectionEnd:a}=n;if(r===a){let a=0,l=0,u="";if(i===o.Z.ENTER?"\n• "!==t.substring(r-3,r)||"\n"!==t.substring(r,r+1)&&r!==t.length?s||"\n"===t.substring(r-1,r)||(a=0,u="\n• "):(a=-3,u="\n"):i!==o.Z.BACKSPACE&&i!==o.Z.DELETE||("\n• "===t.substring(r-3,r)?a=-3:"\n•"===t.substring(r-2,r)?a=-2:"\n"===t.substring(r-1,r)&&"•"===t.substring(r,r+1)&&(a=-1,l=1)),0!==a||0!==l||""!==u){const i=t.substring(0,r+a)+u+t.substring(r+l);m(i);const o=r+a+u.length;setTimeout((()=>{n.selectionStart=o,n.selectionEnd=o}),10),c(d(i)),e.preventDefault()}}}},placeholder:p,rows:7,value:g})})}},146083:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(710159),o=i(123686),s=i(883119),r=i(785893);function a({onUpdate:e,showLabel:t=!0,value:i}){const a=(0,n.ZP)(),d=[];for(let n=1;n<=50;n+=1)d.push({value:String(n),label:(0,o.nk)(a.ngettext("{{ servings }} serving","{{ servings }} servings",n,"storyboard.detailsList.field.servings","Option for number of servings a story pin recipe will provide"),{servings:n}).join("")});return(0,r.jsx)(s.kC,{alignItems:"stretch",justifyContent:"start",width:"100%",children:(0,r.jsx)(s.xu,{width:"100%",position:"relative",children:(0,r.jsx)(s.EI,{size:"lg",id:"servings",name:"servings",label:t?a._("Servings","storyboard.detailsList.field.servings","Header title for serving count entry for story pin recipe"):void 0,placeholder:a._("Pick a serving size","storyboard.detailsList.recipe","Placeholder caption for servings count input in story pin recipe"),value:i,options:d,onChange:({value:t})=>{Number.isNaN(t)||e(t)}})})})}},297608:(e,t,i)=>{i.d(t,{Z:()=>d});var n=i(667294),o=i(710159),s=i(123686),r=i(883119),a=i(785893);function d({header:e,onUpdate:t,value:i}){const d=(0,o.ZP)(),[l,c]=(0,n.useState)(i?String(Math.floor(Number.parseInt(i,10)/60)):"0"),[u,h]=(0,n.useState)(i?String(Number.parseInt(i,10)%60):"0"),p=(e,i)=>{t(String(Number.parseInt(i,10)+60*Number.parseInt(e,10)))},g=[];for(let n=0;n<=9;n+=1)g.push({value:String(n),label:(0,s.nk)(d.ngettext("{{ hours }} hour","{{ hours }} hours",n,"storyboard.detailsList.recipe","Option for number of hours a story pin recipe will take"),{hours:n}).join("")});const m=[];for(let n=0;n<60;n+=1)m.push({value:String(n),label:(0,s.nk)(d.ngettext("{{ minutes }} minute","{{ minutes }} minutes",n,"storyboard.detailsList.recipe","Option for number of minutes a story pin recipe will take"),{minutes:n}).join("")});return(0,a.jsxs)(r.kC,{alignItems:"end",justifyContent:"start",width:"100%",children:[(0,a.jsx)(r.xu,{width:"50%",marginEnd:2,children:(0,a.jsx)(r.EI,{size:"lg",id:"hours",name:"hours",label:e,placeholder:d._("Hours","storyboard.detailsList.recipe","Placeholder caption for hours input in story pin recipe cooktime"),value:l,options:g,onChange:({value:e})=>{Number.isNaN(e)||(c(e),p(e,u))}})}),(0,a.jsx)(r.xu,{width:"50%",marginStart:2,children:(0,a.jsx)(r.EI,{size:"lg",id:"minutes",name:"minutes",placeholder:d._("Minutes","storyboard.detailsList.recipe","Placeholder caption for minutes input in story pin recipe cooktime"),value:u,options:m,onChange:({value:e})=>{Number.isNaN(e)||(h(e),p(l,e))}})})]})}},541937:(e,t,i)=>{i.d(t,{CH:()=>o,Fe:()=>r,_i:()=>s});const n=[0,2,1];function o(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map((e=>{const{heading:t,blocks:i}=e;return{heading:t,blocks:(null!=i?i:[]).map((e=>({text:e.text?e.text:"",type:9}))),type:7}})):[];return{key_value_blocks:i&&i.length>0?i.map((e=>({category_type:e.category_type,type:8,value:e.value}))):[],list_blocks:n}}function s(e){const{list_blocks:t,key_value_blocks:i}=e,n=t&&t.length>0?t.map((e=>{const{heading:t,blocks:i}=e;return{heading:t,items:(null!=i?i:[]).map((e=>e.text?e.text:""))}})):[];return{keyValueBlocks:i&&i.length>0?i.reduce(((e,t)=>{const{category_type:i,value:n}=t;return e[null!=i?i:""]=n,e}),{}):{},listBlocks:n}}function r(e){const{keyValueBlocks:t,listBlocks:i}=e;if(!t&&!i)return null;return{list_blocks:i?i.map((e=>{const{heading:t,items:i}=e;let n=[];return i&&(n=i.map((e=>({text:e,type:9})))),{blocks:n,heading:t,type:7}})):[],key_value_blocks:(t?Object.keys(t).map((e=>{const i=t[e],o=Number.parseInt(e,10),s=n.indexOf(o)>-1&&i===Number.parseInt(i,10).toString();return i&&s?{value:i,category_type:o,type:8}:null})):[]).filter(Boolean)}}},703364:(e,t,i)=>{i.d(t,{Z:()=>c});var n=i(667294),o=i(40142),s=i(588299),r=i(708206),a=i(539195),d=i(786654),l=i(785893);const c=(0,r.compose)((0,o.connect)((({pins:e},{pinId:t,carouselSlotCurrentIndex:i})=>{const{carousel_data:n}=e&&t&&e[t]||{},{index:o}=n||{};return void 0!==i?{carouselSlotCurrentIndex:o||i||0}:{}})),(function(e){return function(t){const{logContextEvent:i}=(0,a.v)(),[o,r]=(0,n.useState)(!1),c=(0,d.Z)({shouldStopEventPropagation:!1}),{pinId:u,onDelete:h,onSubmit:p,carouselSlotCurrentIndex:g}=t;return(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(e,{...t,handlePinEditButtonClick:c((e=>{e&&e.stopPropagation();const{component:n,onToggleModal:o}=t;o&&o(!0),i({event_type:101,element:3,...n?{component:n}:Object.freeze({})}),r(!0)}))}),o&&(0,l.jsx)(s.ZP,{carouselSlotCurrentIndex:g,onDelete:h,onHide:()=>{r(!1),t.onToggleModal&&t.onToggleModal(!1)},onSubmit:p,pinId:u})]})}}))},69941:(e,t,i)=>{i.d(t,{_:()=>o});var n=i(724207);function o(e,t,i,o){return async s=>{const r=n.ZP.create("ApiResource",{url:`/v3/pins/${e}/notes/`,data:{pin_note_content:i,...o?{orbac_subject_id:o}:Object.freeze({})}});let a;a=i?t?await r.callUpdate():await r.callCreate():await r.callDelete();const{resource_response:d}=a;s(function(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}(e,null==d?void 0:d.data))}}},971415:(e,t,i)=>{i.d(t,{Z:()=>r,k:()=>o.k});var n=i(952733),o=i(132551),s=i(785893);const r=({dateFormatType:e,useUTC:t=!0,value:i})=>(0,s.jsx)(n.LC,{children:n=>(0,o.Z)(n.locale,i,e,t)})},246025:(e,t,i)=>{i.d(t,{Z:()=>n});const n=(e,t)=>{const i=new Date(e);return i.setDate(e.getDate()+t),i}},132551:(e,t,i)=>{i.d(t,{Z:()=>o,k:()=>n});const n={LONG:"long",YEAR:"year",WEEKDAY_DATE:"weekday_date",WEEKDAY_DATE_TIME_TIMEZONE:"weekday_date_time_timezone",SHORT_WEEKDAY_DATE:"short_weekday_date",LONG_MONTH_YEAR:"long_month_year",NUMERIC:"numeric",MONTH_DAY:"month_day",SHORT_MONTH:"short_month",SHORT_MONTH_DAY:"short_month_day",DAY:"day",YEAR_SHORT_MONTH_DAY:"year_short_month_day",YEAR_SHORT_MONTH_DAY_HOUR:"year_short_month_day_hour",TIME:"time",TIME_TIMEZONE:"time_timezone",HOUR:"hour"};function o(e,t,i,o=!0){const s=function(e){switch(e){case n.YEAR:return{year:"numeric"};case n.LONG:return{year:"numeric",month:"long",day:"numeric"};case n.NUMERIC:return{year:"numeric",month:"numeric",day:"numeric"};case n.WEEKDAY_DATE:return{weekday:"long",month:"long",day:"numeric",year:"numeric"};case n.SHORT_WEEKDAY_DATE:return{weekday:"short",month:"numeric",day:"numeric"};case n.WEEKDAY_DATE_TIME_TIMEZONE:return{weekday:"short",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"};case n.MONTH_DAY:return{month:"long",day:"numeric"};case n.SHORT_MONTH:return{month:"short"};case n.SHORT_MONTH_DAY:return{month:"short",day:"numeric"};case n.DAY:return{day:"numeric"};case n.LONG_MONTH_YEAR:return{month:"long",year:"numeric"};case n.YEAR_SHORT_MONTH_DAY:return{year:"numeric",month:"short",day:"numeric"};case n.YEAR_SHORT_MONTH_DAY_HOUR:return{month:"short",year:"numeric",day:"numeric",hour:"numeric"};case n.TIME:return{hour:"numeric",minute:"2-digit"};case n.TIME_TIMEZONE:return{hour:"numeric",minute:"2-digit",timeZoneName:"short"};case n.HOUR:return{hour:"numeric"};default:throw new Error('invalid dateFormatType "'+e+'"')}}(i);o&&(s.timeZone="UTC");return new Intl.DateTimeFormat(e,s).format(t)}},685894:(e,t,i)=>{i.d(t,{Cc:()=>l,RR:()=>n,YB:()=>o,YL:()=>r,h8:()=>d,pE:()=>a,yR:()=>s});const n="0.8.0",o=9/16,s=8,r=10;function a(e,t=1){return{x:(null!=e?e:24)/5,y:(null!=e?e:24)*(t-1)}}const d={COMMENT_REPLY_STICKER:"story_pin_comment_reply_block",GENERIC_STICKER:"story_pin_generic_interactive_sticker_block",HEADING:"story_pin_heading_block",IMAGE:"story_pin_image_block",INGREDIENT:"story_pin_ingredient_block",LINK:"story_pin_link_block",MENTION_STICKER:"story_pin_mention_sticker_block",MUSIC:"story_pin_music_block",PARAGRAPH:"story_pin_paragraph_block",PRODUCT_STICKER:"story_pin_product_sticker_block",SUPPLY:"story_pin_supply_block",VIDEO:"story_pin_video_block",VTO_MAKEUP_STICKER:"story_pin_virtual_try_on_makeup_sticker_block"},l={alignment:1,hex_color:"#111111",highlight_color:"#FFFFFF",vertical_alignment:1,font:{default_size:28,id:"1",key:"Graphik-Regular.otf",letter_spacing:-.4,line_height:1.25,name:"Teaspoon",url:"https://s.pinimg.com/story_pins/fonts/Graphik-Regular.otf"},font_size:28}},926842:(e,t,i)=>{function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{B:()=>s,n:()=>o});const o=(e,t)=>{const i=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(null==e||!e.match(i)||null==t||!t.match(i))return null;const n=null==e?void 0:e.split("."),o=null==t?void 0:t.split("."),s=Math.max((null!=n?n:"").length,(null!=o?o:"").length);for(let d=0;d<s;d+=1){var r,a;const e=d<(null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0)?parseInt(null==n?void 0:n[d],10):0,t=d<(null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0)?parseInt(null==o?void 0:o[d],10):0;if(e<t)return-1;if(e>t)return 1}return 0};class s{constructor(e,t,i){n(this,"start",Date.now()),n(this,"paused",!1),this.onProgress=e,this.onComplete=t,this.duration=i,this.remaining=i,"undefined"!=typeof window&&(this.intervalId=window.setInterval((()=>{const e=this.paused?this.duration-this.remaining:this.duration-this.remaining+(Date.now()-this.start);this.onProgress(e/this.duration)}),500),this.resume())}currentTime(){return this.duration-this.remaining}pause(){this.paused=!0,window.clearTimeout(this.timerId),this.remaining-=Date.now()-this.start;const e=this.duration-this.remaining;this.onProgress(e/this.duration)}resume(){this.paused=!1,this.start=Date.now(),window.clearTimeout(this.timerId),this.timerId=window.setTimeout(this.onComplete,this.remaining)}clear(){window.clearTimeout(this.timerId),window.clearInterval(this.intervalId)}}},248355:(e,t,i)=>{i.d(t,{Bh:()=>c,CU:()=>r,FU:()=>w,G$:()=>f,GT:()=>a,Gy:()=>m,J_:()=>j,Jx:()=>p,MZ:()=>x,VC:()=>h,VG:()=>d,ZA:()=>l,Zt:()=>g,a3:()=>k,aH:()=>s,nw:()=>v,oR:()=>y,qA:()=>u,qp:()=>C,sG:()=>_,vd:()=>S,xk:()=>b});var n=i(361086);const o=e=>{const t={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9","　":" "},i=String(e).split("");return i.forEach(((e,n)=>{const o=t[e];o&&(i[n]=o)})),i.join("")};function s(e){return function(t,i){const n=[];t&&/\S/.test(t)||n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}const r=new RegExp(["(^[-!#$%&'*+/=?^_`{}|~0-9A-Z]+(\\.[-!#$%&'*+/=?^_`{}|~0-9A-Z]+)*",'|^"([\\001-\\010\\013\\014\\016-\\037!#-\\[\\]-\\177]|\\\\[\\001-\\011\\013\\014\\016-\\177])*"',")@((?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\\.)+[A-Z]{2,20}$)","|\\[(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}\\]$"].join(""),"i");function a(e){return function(t,i){const n=[];(t=t&&t.trim())&&!t.match(r)&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function d(e){return function(t,i){const n=[];(t=t&&t.trim())&&!t.match(/^[^0-9].*$/)&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function l(e){return function(t,i){const n=[];t&&(Number.isNaN(parseInt(t))&&n.push(e.invalidAgeString),e.ageTooShortString&&t<10&&n.push(e.ageTooShortString),t<=0||t>=300?n.push(e.invalidAgeString):e.checkUnderAgeWithString&&t<13&&n.push(e.checkUnderAgeWithString));const o={errors:n,warnings:[]};return i&&i(o),o}}function c(e){return function(t,i){const n=(t=t&&t.trim()).replace(/[\(\)\+\-\. ]/g,""),o=[],s=!1!==e.checkLength&&n.length<7;!t||t.match(/^(\(?\+?[0-9]*\)?)?[0-9_\- \.\(\)]*$/g)&&!s||o.push(e.message);const r={errors:o,warnings:[]};return i&&i(r),r}}function u(e){return function(t,i){const n=/^\d+$/,s=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=o(t))&&!t.match(n)&&s.push(e.message));const r={errors:s,warnings:[]};return i&&i(r),r}}function h(e){return function(t,i){const n=/^[\d\ -]+$/,s=[];"number"==typeof t||"string"==typeof t&&(t=t&&t.trim(),(t=o(t))&&!t.match(n)&&s.push(e.message));const r={errors:s,warnings:[]};return i&&i(r),r}}function p(e){return function(t,i){const n=[];t&&!t.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi)&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function g(e){return function(t,i){const o=[];if(t)try{const i=(0,n.Z)(t);i&&i.protocol&&("http"!==i.protocol||"localhost"===i.hostname)||o.push(e.message)}catch(r){o.push(e.message)}const s={errors:o,warnings:[]};return i&&i(s),s}}function m(e){return function(t,i){const n=[];(e.should_trim||!1)&&(t=t&&t.trim());const o=t.length;e.min&&o<e.min?n.push(e.minErrorString):e.max&&o>e.max&&n.push(e.maxErrorString);const s={errors:n,warnings:[]};return i&&i(s),s}}function x(e){return function(t,i){const n=!e.checkExclusion,o=e.substrings,s=[];(n&&!o.some((e=>t.includes(e)))||!n&&o.some((e=>t.includes(e))))&&s.push(e.message);const r={errors:s,warnings:[]};return i&&i(r),r}}function _(e){return function(t,i){const n=[];t!==(e&&e.targetValue)&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function f(e){return function(t,i){t&&(t=parseFloat(t));const n=[];t<=e.value&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function v(e){return function(t,i){t&&(t=parseFloat(t));const n=[];t<e.value&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function y(e){return function(t,i){const n=[];/^[\040-\176]*$/.test(t)||n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function b(e){return function(t,i){let n=2;if(e.hasFractionalCents)n=3;else if(e.currencyCode){const{maximumFractionDigits:t}=new Intl.NumberFormat(void 0,{style:"currency",currency:e.currencyCode}).resolvedOptions();n=t}const o=new RegExp(n?`^\\d*(\\.\\d{1,${n}})?$`:"^\\d*$"),s=[];"number"==typeof t&&(t=t.toString()),t&&!t.match(o)&&(t=t&&t.trim(),s.push(e.message));const r={errors:s,warnings:[]};return i&&i(r),r}}function j(e){return function(t,i){t=t&&t.trim();const n=[],o=new Date(t);t&&!o.getTime()&&n.push(e.message);const s={errors:n,warnings:[]};return i&&i(s),s}}function C(e){return function(t,i){const n=[];(t=t&&t.trim())&&!t.match(/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/)&&n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function S(e){return function(t,i){const n=[];e.pattern.test(t)||n.push(e.message);const o={errors:n,warnings:[]};return i&&i(o),o}}function w(e,t){const i=e.map((e=>e(t).errors));return[].concat(...i)}function k(e,t){let i="";return t.some((t=>{const n=t(e);return n.errors.length>0&&(i=n.errors[0],!0)})),i}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/49150-81bd501794314ede.mjs.map